{"ast":null,"code":"var _jsxFileName = \"G:\\\\HK4\\\\fe\\\\src\\\\pages\\\\ProductDetail.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState, useContext, useMemo } from \"react\";\nimport { useParams, useNavigate } from \"react-router-dom\";\nimport axios from \"axios\";\nimport \"../css/page/ProductDetail.css\";\nimport ProfileHeader from \"../components/page/PageHeader\";\nimport { DataContext } from \"../DataContext\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function ProductDetail() {\n  _s();\n  var _product$imageUrls;\n  const {\n    id\n  } = useParams();\n  const navigate = useNavigate();\n  const {\n    token,\n    setToken\n  } = useContext(DataContext);\n  const [product, setProduct] = useState(null);\n  const [user, setUser] = useState(null);\n  const [reviews, setReviews] = useState([]);\n\n  // filter + sort state cho ph·∫ßn ƒë√°nh gi√°\n  const [starFilter, setStarFilter] = useState(0); // 0 = t·∫•t c·∫£, 1..5 = l·ªçc theo sao\n  const [hasCommentOnly, setHasCommentOnly] = useState(false);\n  const [sortType, setSortType] = useState(\"newest\"); // newest | oldest | highest | lowest\n\n  // ================= LOAD PRODUCT =================\n  useEffect(() => {\n    axios.get(`http://localhost:8080/api/products/${id}`).then(res => setProduct(res.data.data)).catch(err => console.log(err));\n  }, [id]);\n\n  // ================= LOAD REVIEWS THEO PRODUCT =================\n  useEffect(() => {\n    axios.get(`http://localhost:8080/api/reviews/product/${id}`).then(res => setReviews(res.data || [])).catch(err => console.log(err));\n  }, [id]);\n\n  // ================= LOAD USER n·∫øu ƒë√£ login =================\n  useEffect(() => {\n    const localToken = localStorage.getItem(\"trip-token\");\n    if (!localToken) {\n      setUser(null);\n      return;\n    }\n    axios.get(\"http://localhost:8080/api/auth/user/me\", {\n      headers: {\n        Authorization: `Bearer ${localToken}`\n      }\n    }).then(res => setUser(res.data.data)).catch(() => setUser(null));\n  }, [token]);\n\n  // ================= ADD TO CART (THEO USER) =================\n  const addToCart = () => {\n    const localToken = localStorage.getItem(\"trip-token\");\n    if (!localToken || !user) {\n      alert(\"B·∫°n c·∫ßn ƒëƒÉng nh·∫≠p ƒë·ªÉ th√™m v√†o gi·ªè h√†ng!\");\n      navigate(\"/login\");\n      return;\n    }\n    const key = `cart_${user.email}`;\n    let cart = JSON.parse(localStorage.getItem(key)) || [];\n    const exist = cart.find(item => item.id === product.id);\n    if (exist) {\n      exist.quantity += 1;\n    } else {\n      cart.push({\n        ...product,\n        quantity: 1\n      });\n    }\n    localStorage.setItem(key, JSON.stringify(cart));\n    window.dispatchEvent(new Event(\"storage\"));\n    alert(\"ƒê√£ th√™m v√†o gi·ªè!\");\n  };\n  const buyNow = () => {\n    addToCart();\n    navigate(\"/cart\");\n  };\n\n  // ================= T√çNH TH·ªêNG K√ä SAO =================\n  const ratingStats = useMemo(() => {\n    const total = reviews.length;\n    if (total === 0) {\n      return {\n        avg: 0,\n        total: 0,\n        bars: [0, 0, 0, 0, 0]\n      };\n    }\n    const bars = [0, 0, 0, 0, 0]; // index 0 -> 1 sao, index 4 -> 5 sao\n\n    let sum = 0;\n    reviews.forEach(r => {\n      const rt = r.rating || 0;\n      sum += rt;\n      if (rt >= 1 && rt <= 5) {\n        bars[rt - 1]++;\n      }\n    });\n    const avg = sum / total;\n    return {\n      avg,\n      total,\n      bars\n    };\n  }, [reviews]);\n\n  // ================= FILTER + SORT REVIEWS =================\n  const filteredReviews = useMemo(() => {\n    let list = [...reviews];\n    if (starFilter > 0) {\n      list = list.filter(r => r.rating === starFilter);\n    }\n    if (hasCommentOnly) {\n      list = list.filter(r => r.comment && r.comment.trim() !== \"\");\n    }\n    list.sort((a, b) => {\n      switch (sortType) {\n        case \"newest\":\n          return new Date(b.createdAt) - new Date(a.createdAt);\n        case \"oldest\":\n          return new Date(a.createdAt) - new Date(b.createdAt);\n        case \"highest\":\n          return (b.rating || 0) - (a.rating || 0);\n        case \"lowest\":\n          return (a.rating || 0) - (b.rating || 0);\n        default:\n          return 0;\n      }\n    });\n    return list;\n  }, [reviews, starFilter, hasCommentOnly, sortType]);\n\n  // ================= RENDER STARS =================\n  const renderStars = rating => {\n    if (!rating || rating <= 0) return \"Ch∆∞a c√≥ ƒë√°nh gi√°\";\n    const full = Math.round(rating);\n    return \"‚≠ê\".repeat(full) + \"‚òÜ\".repeat(5 - full);\n  };\n  if (!product) return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"loading\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"spinner-border text-danger\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 158,\n      columnNumber: 9\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 157,\n    columnNumber: 7\n  }, this);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"pd-container\",\n    children: [/*#__PURE__*/_jsxDEV(ProfileHeader, {\n      user: user,\n      onLogout: () => {\n        localStorage.removeItem(\"trip-token\");\n        setToken(null);\n        setUser(null);\n        window.location.href = \"/\";\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 164,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"pd-content\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"pd-left\",\n        children: /*#__PURE__*/_jsxDEV(\"img\", {\n          src: (_product$imageUrls = product.imageUrls) === null || _product$imageUrls === void 0 ? void 0 : _product$imageUrls[0],\n          alt: product.name\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 177,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 176,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"pd-right\",\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          className: \"pd-name\",\n          children: product.name\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 183,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"pd-rating-line\",\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"pd-rating-score\",\n            children: ratingStats.avg ? ratingStats.avg.toFixed(1) : \"0.0\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 186,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"pd-rating-stars\",\n            children: renderStars(ratingStats.avg)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 189,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"pd-rating-count\",\n            children: [\"(\", ratingStats.total, \" \\u0111\\xE1nh gi\\xE1)\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 192,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 185,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"pd-price\",\n          children: [product.price.toLocaleString(), \" \\u20AB\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 197,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"pd-actions\",\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"pd-buy\",\n            onClick: buyNow,\n            children: \"Mua ngay\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 202,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"pd-add\",\n            onClick: addToCart,\n            children: \"Th\\xEAm v\\xE0o gi\\u1ECF\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 206,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 201,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n          className: \"pd-spec\",\n          children: [/*#__PURE__*/_jsxDEV(\"li\", {\n            children: [\"\\u26A1 Chip: \", product.chipset]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 212,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n            children: [\"\\uD83D\\uDD0B Pin: \", product.battery]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 213,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n            children: [\"\\uD83D\\uDCBE RAM: \", product.ram]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 214,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n            children: [\"\\uD83D\\uDCBD B\\u1ED9 nh\\u1EDB: \", product.storage]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 215,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n            children: [\"\\uD83C\\uDFA8 M\\xE0u: \", product.color]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 216,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 211,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 182,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 174,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"pd-desc\",\n      children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n        children: \"M\\xF4 t\\u1EA3 s\\u1EA3n ph\\u1EA9m\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 223,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: product.description\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 224,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 222,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"pd-review-section\",\n      children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n        children: \"\\u0110\\xE1nh gi\\xE1 s\\u1EA3n ph\\u1EA9m\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 229,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"pd-rating-box\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"pd-rating-left\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"pd-rating-number\",\n            children: ratingStats.avg ? ratingStats.avg.toFixed(1) : \"0.0\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 234,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"pd-stars-big\",\n            children: renderStars(ratingStats.avg)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 237,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"pd-total\",\n            children: [ratingStats.total, \" \\u0111\\xE1nh gi\\xE1\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 240,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 233,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"pd-rating-right\",\n          children: [5, 4, 3, 2, 1].map(s => {\n            const total = ratingStats.total || 1;\n            const count = ratingStats.bars[s - 1] || 0;\n            const percent = count / total * 100;\n            return /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"pd-bar\",\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                children: [s, \" sao\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 252,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"pd-bg\",\n                children: /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"pd-fill\",\n                  style: {\n                    width: `${percent}%`\n                  }\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 254,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 253,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"pd-bar-count\",\n                children: count\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 259,\n                columnNumber: 19\n              }, this)]\n            }, s, true, {\n              fileName: _jsxFileName,\n              lineNumber: 251,\n              columnNumber: 17\n            }, this);\n          })\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 245,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 232,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"pd-filter-row\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"pd-filter-stars\",\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"pd-filter-btn \" + (starFilter === 0 ? \"active\" : \"\"),\n            onClick: () => setStarFilter(0),\n            children: \"T\\u1EA5t c\\u1EA3\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 269,\n            columnNumber: 13\n          }, this), [5, 4, 3, 2, 1].map(s => /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"pd-filter-btn \" + (starFilter === s ? \"active\" : \"\"),\n            onClick: () => setStarFilter(s),\n            children: [s, \" sao\"]\n          }, s, true, {\n            fileName: _jsxFileName,\n            lineNumber: 278,\n            columnNumber: 15\n          }, this)), /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"pd-filter-btn \" + (hasCommentOnly ? \"active\" : \"\"),\n            onClick: () => setHasCommentOnly(v => !v),\n            children: \"C\\xF3 b\\xECnh lu\\u1EADn\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 289,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 268,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"pd-sort\",\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            children: \"S\\u1EAFp x\\u1EBFp: \"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 300,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n            value: sortType,\n            onChange: e => setSortType(e.target.value),\n            children: [/*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"newest\",\n              children: \"M\\u1EDBi nh\\u1EA5t\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 305,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"oldest\",\n              children: \"C\\u0169 nh\\u1EA5t\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 306,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"highest\",\n              children: \"Sao cao \\u0111\\u1EBFn th\\u1EA5p\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 307,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"lowest\",\n              children: \"Sao th\\u1EA5p \\u0111\\u1EBFn cao\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 308,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 301,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 299,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 267,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"pd-review-list\",\n        children: [filteredReviews.length === 0 && /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"pd-no-review\",\n          children: \"Ch\\u01B0a c\\xF3 \\u0111\\xE1nh gi\\xE1 ph\\xF9 h\\u1EE3p v\\u1EDBi b\\u1ED9 l\\u1ECDc.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 316,\n          columnNumber: 13\n        }, this), filteredReviews.map(r => {\n          var _r$userName, _r$userName$charAt;\n          return /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"pd-review\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"pd-review-header\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"pd-review-avatar\",\n                children: ((_r$userName = r.userName) === null || _r$userName === void 0 ? void 0 : (_r$userName$charAt = _r$userName.charAt(0)) === null || _r$userName$charAt === void 0 ? void 0 : _r$userName$charAt.toUpperCase()) || \"U\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 324,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"pd-review-name\",\n                  children: r.userName\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 328,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"pd-review-stars\",\n                  children: \"‚≠ê\".repeat(r.rating || 0)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 329,\n                  columnNumber: 19\n                }, this), r.createdAt && /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"pd-review-date\",\n                  children: new Date(r.createdAt).toLocaleDateString(\"vi-VN\")\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 333,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 327,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 323,\n              columnNumber: 15\n            }, this), r.comment && /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"pd-review-comment\",\n              children: r.comment\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 341,\n              columnNumber: 17\n            }, this), r.adminReply && /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"pd-admin-reply\",\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"pd-admin-label\",\n                children: \"Ph\\u1EA3n h\\u1ED3i c\\u1EE7a shop:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 346,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                children: r.adminReply\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 347,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 345,\n              columnNumber: 17\n            }, this)]\n          }, r.id, true, {\n            fileName: _jsxFileName,\n            lineNumber: 322,\n            columnNumber: 13\n          }, this);\n        })]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 314,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 228,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 163,\n    columnNumber: 5\n  }, this);\n}\n_s(ProductDetail, \"xwsCyarxztFFj0CkoXJhyyFFox8=\", false, function () {\n  return [useParams, useNavigate];\n});\n_c = ProductDetail;\nvar _c;\n$RefreshReg$(_c, \"ProductDetail\");","map":{"version":3,"names":["React","useEffect","useState","useContext","useMemo","useParams","useNavigate","axios","ProfileHeader","DataContext","jsxDEV","_jsxDEV","ProductDetail","_s","_product$imageUrls","id","navigate","token","setToken","product","setProduct","user","setUser","reviews","setReviews","starFilter","setStarFilter","hasCommentOnly","setHasCommentOnly","sortType","setSortType","get","then","res","data","catch","err","console","log","localToken","localStorage","getItem","headers","Authorization","addToCart","alert","key","email","cart","JSON","parse","exist","find","item","quantity","push","setItem","stringify","window","dispatchEvent","Event","buyNow","ratingStats","total","length","avg","bars","sum","forEach","r","rt","rating","filteredReviews","list","filter","comment","trim","sort","a","b","Date","createdAt","renderStars","full","Math","round","repeat","className","children","fileName","_jsxFileName","lineNumber","columnNumber","onLogout","removeItem","location","href","src","imageUrls","alt","name","toFixed","price","toLocaleString","onClick","chipset","battery","ram","storage","color","description","map","s","count","percent","style","width","v","value","onChange","e","target","_r$userName","_r$userName$charAt","userName","charAt","toUpperCase","toLocaleDateString","adminReply","_c","$RefreshReg$"],"sources":["G:/HK4/fe/src/pages/ProductDetail.js"],"sourcesContent":["import React, { useEffect, useState, useContext, useMemo } from \"react\";\r\nimport { useParams, useNavigate } from \"react-router-dom\";\r\nimport axios from \"axios\";\r\nimport \"../css/page/ProductDetail.css\";\r\nimport ProfileHeader from \"../components/page/PageHeader\";\r\nimport { DataContext } from \"../DataContext\";\r\n\r\nexport default function ProductDetail() {\r\n  const { id } = useParams();\r\n  const navigate = useNavigate();\r\n\r\n  const { token, setToken } = useContext(DataContext);\r\n\r\n  const [product, setProduct] = useState(null);\r\n  const [user, setUser] = useState(null);\r\n  const [reviews, setReviews] = useState([]);\r\n\r\n  // filter + sort state cho ph·∫ßn ƒë√°nh gi√°\r\n  const [starFilter, setStarFilter] = useState(0); // 0 = t·∫•t c·∫£, 1..5 = l·ªçc theo sao\r\n  const [hasCommentOnly, setHasCommentOnly] = useState(false);\r\n  const [sortType, setSortType] = useState(\"newest\"); // newest | oldest | highest | lowest\r\n\r\n  // ================= LOAD PRODUCT =================\r\n  useEffect(() => {\r\n    axios\r\n      .get(`http://localhost:8080/api/products/${id}`)\r\n      .then((res) => setProduct(res.data.data))\r\n      .catch((err) => console.log(err));\r\n  }, [id]);\r\n\r\n  // ================= LOAD REVIEWS THEO PRODUCT =================\r\n  useEffect(() => {\r\n    axios\r\n      .get(`http://localhost:8080/api/reviews/product/${id}`)\r\n      .then((res) => setReviews(res.data || []))\r\n      .catch((err) => console.log(err));\r\n  }, [id]);\r\n\r\n  // ================= LOAD USER n·∫øu ƒë√£ login =================\r\n  useEffect(() => {\r\n    const localToken = localStorage.getItem(\"trip-token\");\r\n    if (!localToken) {\r\n      setUser(null);\r\n      return;\r\n    }\r\n\r\n    axios\r\n      .get(\"http://localhost:8080/api/auth/user/me\", {\r\n        headers: { Authorization: `Bearer ${localToken}` },\r\n      })\r\n      .then((res) => setUser(res.data.data))\r\n      .catch(() => setUser(null));\r\n  }, [token]);\r\n\r\n  // ================= ADD TO CART (THEO USER) =================\r\n  const addToCart = () => {\r\n    const localToken = localStorage.getItem(\"trip-token\");\r\n\r\n    if (!localToken || !user) {\r\n      alert(\"B·∫°n c·∫ßn ƒëƒÉng nh·∫≠p ƒë·ªÉ th√™m v√†o gi·ªè h√†ng!\");\r\n      navigate(\"/login\");\r\n      return;\r\n    }\r\n\r\n    const key = `cart_${user.email}`;\r\n    let cart = JSON.parse(localStorage.getItem(key)) || [];\r\n\r\n    const exist = cart.find((item) => item.id === product.id);\r\n\r\n    if (exist) {\r\n      exist.quantity += 1;\r\n    } else {\r\n      cart.push({ ...product, quantity: 1 });\r\n    }\r\n\r\n    localStorage.setItem(key, JSON.stringify(cart));\r\n    window.dispatchEvent(new Event(\"storage\"));\r\n    alert(\"ƒê√£ th√™m v√†o gi·ªè!\");\r\n  };\r\n\r\n  const buyNow = () => {\r\n    addToCart();\r\n    navigate(\"/cart\");\r\n  };\r\n\r\n  // ================= T√çNH TH·ªêNG K√ä SAO =================\r\n  const ratingStats = useMemo(() => {\r\n    const total = reviews.length;\r\n    if (total === 0) {\r\n      return {\r\n        avg: 0,\r\n        total: 0,\r\n        bars: [0, 0, 0, 0, 0],\r\n      };\r\n    }\r\n\r\n    const bars = [0, 0, 0, 0, 0]; // index 0 -> 1 sao, index 4 -> 5 sao\r\n\r\n    let sum = 0;\r\n    reviews.forEach((r) => {\r\n      const rt = r.rating || 0;\r\n      sum += rt;\r\n      if (rt >= 1 && rt <= 5) {\r\n        bars[rt - 1]++;\r\n      }\r\n    });\r\n\r\n    const avg = sum / total;\r\n\r\n    return {\r\n      avg,\r\n      total,\r\n      bars,\r\n    };\r\n  }, [reviews]);\r\n\r\n  // ================= FILTER + SORT REVIEWS =================\r\n  const filteredReviews = useMemo(() => {\r\n    let list = [...reviews];\r\n\r\n    if (starFilter > 0) {\r\n      list = list.filter((r) => r.rating === starFilter);\r\n    }\r\n\r\n    if (hasCommentOnly) {\r\n      list = list.filter((r) => r.comment && r.comment.trim() !== \"\");\r\n    }\r\n\r\n    list.sort((a, b) => {\r\n      switch (sortType) {\r\n        case \"newest\":\r\n          return new Date(b.createdAt) - new Date(a.createdAt);\r\n        case \"oldest\":\r\n          return new Date(a.createdAt) - new Date(b.createdAt);\r\n        case \"highest\":\r\n          return (b.rating || 0) - (a.rating || 0);\r\n        case \"lowest\":\r\n          return (a.rating || 0) - (b.rating || 0);\r\n        default:\r\n          return 0;\r\n      }\r\n    });\r\n\r\n    return list;\r\n  }, [reviews, starFilter, hasCommentOnly, sortType]);\r\n\r\n  // ================= RENDER STARS =================\r\n  const renderStars = (rating) => {\r\n    if (!rating || rating <= 0) return \"Ch∆∞a c√≥ ƒë√°nh gi√°\";\r\n\r\n    const full = Math.round(rating);\r\n    return \"‚≠ê\".repeat(full) + \"‚òÜ\".repeat(5 - full);\r\n  };\r\n\r\n  if (!product)\r\n    return (\r\n      <div className=\"loading\">\r\n        <div className=\"spinner-border text-danger\"></div>\r\n      </div>\r\n    );\r\n\r\n  return (\r\n    <div className=\"pd-container\">\r\n      <ProfileHeader\r\n        user={user}\r\n        onLogout={() => {\r\n          localStorage.removeItem(\"trip-token\");\r\n          setToken(null);\r\n          setUser(null);\r\n          window.location.href = \"/\";\r\n        }}\r\n      />\r\n\r\n      <div className=\"pd-content\">\r\n        {/* LEFT: ·∫¢NH */}\r\n        <div className=\"pd-left\">\r\n          <img src={product.imageUrls?.[0]\r\n} alt={product.name} />\r\n        </div>\r\n\r\n        {/* RIGHT: TH√îNG TIN S·∫¢N PH·∫®M */}\r\n        <div className=\"pd-right\">\r\n          <h2 className=\"pd-name\">{product.name}</h2>\r\n\r\n          <div className=\"pd-rating-line\">\r\n            <span className=\"pd-rating-score\">\r\n              {ratingStats.avg ? ratingStats.avg.toFixed(1) : \"0.0\"}\r\n            </span>\r\n            <span className=\"pd-rating-stars\">\r\n              {renderStars(ratingStats.avg)}\r\n            </span>\r\n            <span className=\"pd-rating-count\">\r\n              ({ratingStats.total} ƒë√°nh gi√°)\r\n            </span>\r\n          </div>\r\n\r\n          <span className=\"pd-price\">\r\n            {product.price.toLocaleString()} ‚Ç´\r\n          </span>\r\n\r\n          <div className=\"pd-actions\">\r\n            <button className=\"pd-buy\" onClick={buyNow}>\r\n              Mua ngay\r\n            </button>\r\n\r\n            <button className=\"pd-add\" onClick={addToCart}>\r\n              Th√™m v√†o gi·ªè\r\n            </button>\r\n          </div>\r\n\r\n          <ul className=\"pd-spec\">\r\n            <li>‚ö° Chip: {product.chipset}</li>\r\n            <li>üîã Pin: {product.battery}</li>\r\n            <li>üíæ RAM: {product.ram}</li>\r\n            <li>üíΩ B·ªô nh·ªõ: {product.storage}</li>\r\n            <li>üé® M√†u: {product.color}</li>\r\n          </ul>\r\n        </div>\r\n      </div>\r\n\r\n      {/* M√î T·∫¢ */}\r\n      <div className=\"pd-desc\">\r\n        <h3>M√¥ t·∫£ s·∫£n ph·∫©m</h3>\r\n        <p>{product.description}</p>\r\n      </div>\r\n\r\n      {/* ============= ƒê√ÅNH GI√Å S·∫¢N PH·∫®M ============= */}\r\n      <div className=\"pd-review-section\">\r\n        <h3>ƒê√°nh gi√° s·∫£n ph·∫©m</h3>\r\n\r\n        {/* T·ªïng quan rating gi·ªëng Shopee */}\r\n        <div className=\"pd-rating-box\">\r\n          <div className=\"pd-rating-left\">\r\n            <div className=\"pd-rating-number\">\r\n              {ratingStats.avg ? ratingStats.avg.toFixed(1) : \"0.0\"}\r\n            </div>\r\n            <div className=\"pd-stars-big\">\r\n              {renderStars(ratingStats.avg)}\r\n            </div>\r\n            <div className=\"pd-total\">\r\n              {ratingStats.total} ƒë√°nh gi√°\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"pd-rating-right\">\r\n            {[5, 4, 3, 2, 1].map((s) => {\r\n              const total = ratingStats.total || 1;\r\n              const count = ratingStats.bars[s - 1] || 0;\r\n              const percent = (count / total) * 100;\r\n              return (\r\n                <div key={s} className=\"pd-bar\">\r\n                  <span>{s} sao</span>\r\n                  <div className=\"pd-bg\">\r\n                    <div\r\n                      className=\"pd-fill\"\r\n                      style={{ width: `${percent}%` }}\r\n                    ></div>\r\n                  </div>\r\n                  <span className=\"pd-bar-count\">{count}</span>\r\n                </div>\r\n              );\r\n            })}\r\n          </div>\r\n        </div>\r\n\r\n        {/* FILTER + SORT gi·ªëng Shopee */}\r\n        <div className=\"pd-filter-row\">\r\n          <div className=\"pd-filter-stars\">\r\n            <button\r\n              className={\r\n                \"pd-filter-btn \" + (starFilter === 0 ? \"active\" : \"\")\r\n              }\r\n              onClick={() => setStarFilter(0)}\r\n            >\r\n              T·∫•t c·∫£\r\n            </button>\r\n            {[5, 4, 3, 2, 1].map((s) => (\r\n              <button\r\n                key={s}\r\n                className={\r\n                  \"pd-filter-btn \" + (starFilter === s ? \"active\" : \"\")\r\n                }\r\n                onClick={() => setStarFilter(s)}\r\n              >\r\n                {s} sao\r\n              </button>\r\n            ))}\r\n\r\n            <button\r\n              className={\r\n                \"pd-filter-btn \" + (hasCommentOnly ? \"active\" : \"\")\r\n              }\r\n              onClick={() => setHasCommentOnly((v) => !v)}\r\n            >\r\n              C√≥ b√¨nh lu·∫≠n\r\n            </button>\r\n          </div>\r\n\r\n          <div className=\"pd-sort\">\r\n            <span>S·∫Øp x·∫øp: </span>\r\n            <select\r\n              value={sortType}\r\n              onChange={(e) => setSortType(e.target.value)}\r\n            >\r\n              <option value=\"newest\">M·ªõi nh·∫•t</option>\r\n              <option value=\"oldest\">C≈© nh·∫•t</option>\r\n              <option value=\"highest\">Sao cao ƒë·∫øn th·∫•p</option>\r\n              <option value=\"lowest\">Sao th·∫•p ƒë·∫øn cao</option>\r\n            </select>\r\n          </div>\r\n        </div>\r\n\r\n        {/* DANH S√ÅCH REVIEW */}\r\n        <div className=\"pd-review-list\">\r\n          {filteredReviews.length === 0 && (\r\n            <p className=\"pd-no-review\">\r\n              Ch∆∞a c√≥ ƒë√°nh gi√° ph√π h·ª£p v·ªõi b·ªô l·ªçc.\r\n            </p>\r\n          )}\r\n\r\n          {filteredReviews.map((r) => (\r\n            <div key={r.id} className=\"pd-review\">\r\n              <div className=\"pd-review-header\">\r\n                <div className=\"pd-review-avatar\">\r\n                  {r.userName?.charAt(0)?.toUpperCase() || \"U\"}\r\n                </div>\r\n                <div>\r\n                  <div className=\"pd-review-name\">{r.userName}</div>\r\n                  <div className=\"pd-review-stars\">\r\n                    {\"‚≠ê\".repeat(r.rating || 0)}\r\n                  </div>\r\n                  {r.createdAt && (\r\n                    <div className=\"pd-review-date\">\r\n                      {new Date(r.createdAt).toLocaleDateString(\"vi-VN\")}\r\n                    </div>\r\n                  )}\r\n                </div>\r\n              </div>\r\n\r\n              {r.comment && (\r\n                <p className=\"pd-review-comment\">{r.comment}</p>\r\n              )}\r\n\r\n              {r.adminReply && (\r\n                <div className=\"pd-admin-reply\">\r\n                  <span className=\"pd-admin-label\">Ph·∫£n h·ªìi c·ªßa shop:</span>\r\n                  <p>{r.adminReply}</p>\r\n                </div>\r\n              )}\r\n            </div>\r\n          ))}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}